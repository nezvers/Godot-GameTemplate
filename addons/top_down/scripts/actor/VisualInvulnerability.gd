class_name VisualInvulnerability
extends Node

@export var resource_node:ResourceNode
@export var animation_player:AnimationPlayer
@export var animation_invulnerable:StringName
@export var animation_normal:StringName

func _ready()->void:
	var _receive_damage_bool:BoolResource = resource_node.get_resource("receive_damage")
	assert(_receive_damage_bool != null)
	_receive_damage_bool.changed_false.connect(_set_invulnerability_animation.bind(true))
	_receive_damage_bool.changed_true.connect(_set_invulnerability_animation.bind(false))
	
	# in case used with PoolNode
	request_ready()
	# _receive_damage_bool is unique every time, so no need to disconnect on tree_exiting

func _set_invulnerability_animation(value:bool)->void:
	if value:
		animation_player.play(animation_invulnerable)
	else:
		animation_player.play(animation_normal)
